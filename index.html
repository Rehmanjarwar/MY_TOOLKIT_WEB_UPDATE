<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>VIP Key Portal</title>
<style>
  /* ---------- Global ---------- */
  * { box-sizing: border-box; margin:0; padding:0; }
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0f0f0f; color: #fff; text-align: center; }
  a { text-decoration: none; }
  .hidden { display: none; }

  /* ---------- Login Section ---------- */
  #loginSection { padding: 40px; max-width: 400px; margin: 50px auto; background: #1b1b1b; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.7); }
  #loginSection input[type="text"] { width: 100%; padding: 12px; margin-top: 15px; border-radius: 8px; border: none; font-size: 16px; }
  #loginSection button { margin-top: 20px; padding: 12px 25px; font-size: 18px; border-radius: 10px; border:none; background: linear-gradient(90deg,#ff512f,#dd2476); cursor: pointer; transition: 0.3s; }
  #loginSection button:hover { opacity: 0.85; }
  .checkbox-label { margin-left: 8px; font-size: 14px; }
  .get-key { margin-left: 10px; color: #1eff00; cursor: pointer; text-decoration: underline; font-weight: bold; }

  /* ---------- Popup ---------- */
  .popup { display: none; position: fixed; left: 50%; top: 25%; transform: translate(-50%, -50%); padding: 20px 30px; border-radius: 12px; font-weight: bold; font-size: 20px; z-index: 1000; }
  .popup.show { display: block; }
  .popup.success { background-color: #4caf50; }
  .popup.error { background-color: #f44336; }

  /* ---------- VIP Section ---------- */
  #vipSection { max-width: 900px; margin: 20px auto; padding: 20px; background: #1b1b1b; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.7); }
  #vipSection img { width: 150px; margin-bottom: 15px; border-radius: 50%; border: 3px solid #ff2476; }
  #vipSection h3 { margin-bottom: 20px; color: #ff512f; }

  /* ---------- Countdown ---------- */
  .countdown { display: flex; justify-content: center; gap: 15px; margin-bottom: 25px; }
  .countdown div { background: #2a2a2a; padding: 12px 20px; border-radius: 12px; font-weight: bold; }
  .label { font-size: 12px; font-weight: normal; color: #aaa; margin-top: 4px; }

  /* ---------- Search ---------- */
  .search-container { margin-bottom: 20px; }
  .search-container input { padding: 8px 12px; width: 250px; border-radius: 8px; border: none; font-size: 14px; }
  .search-container button { padding: 8px 15px; margin-left: 8px; border:none; border-radius: 8px; background: #ff512f; cursor: pointer; transition: 0.3s; }
  .search-container button:hover { opacity: 0.85; }

  /* ---------- Buttons Grid ---------- */
  .buttons-container { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-bottom: 20px; }
  .box { display: block; width: 180px; padding: 15px; border-radius: 15px; font-weight: bold; text-align: center; color: #fff; transition: 0.3s; box-shadow: 0 0 10px rgba(0,0,0,0.5); }
  .old-bin { background: linear-gradient(135deg,#00c6ff,#0072ff); }
  .new-bin { background: linear-gradient(135deg,#ff512f,#dd2476); }
  .box:hover { transform: scale(1.05); }

  .bin-title { font-size: 16px; color: #aaa; margin-bottom: 10px; }
</style>
</head>
<body>

<!-- Login -->
<div id="loginSection">
  <h2>VIP Key Login</h2>
  <input type="text" id="loginKey" placeholder="Enter your key" />
  <div style="margin-top:10px;">
    <input type="checkbox" id="saveKey" checked>
    <label class="checkbox-label" for="saveKey">Save Key</label>
    <span class="get-key" onclick="window.open('https://wa.me/923220188556', '_blank')">Get Key</span>
  </div>
  <button onclick="checkKey()">LOGIN</button>
  <div id="popup" class="popup"></div>
</div>

<!-- VIP Section -->
<div id="vipSection" class="hidden">
  <img src="https://cdn.discordapp.com/attachments/1159138281189816410/1159140670489632859/AR_HACKER_OFFICIAL_BOY.jpg" alt="VIP" />
  <h3>Welcome VIP Users</h3>

  <!-- Countdown -->
  <div class="countdown">
    <div><div id="days">0</div><div class="label">DAYS</div></div>
    <div><div id="hours">0</div><div class="label">HOURS</div></div>
    <div><div id="minutes">0</div><div class="label">MINUTES</div></div>
    <div><div id="seconds">0</div><div class="label">SECONDS</div></div>
  </div>

  <!-- Search -->
  <div class="search-container">
    <input type="text" id="searchBox" placeholder="Search buttons..." />
    <button onclick="searchButtons()">SEARCH</button>
  </div>

  <!-- Old Bin -->
  <div class="bin-title">Old Bin Buttons</div>
  <div id="dynamicButtons" class="buttons-container"></div>

  <!-- New Bin -->
  <div class="bin-title">New Bin Buttons</div>
  <div id="dynamicButtons2" class="buttons-container"></div>
</div>

<script>
const BIN_ID = "68b1606fae596e708fdacd3e";  // Key bin
const BTN_BIN_ID = "68b1dd9bae596e708fdb419d"; // Old buttons bin
const BTN_BIN_ID_2 = "68b6c360ae596e708fe00162"; // New bin PANIL
const API_KEY = "$2a$10$nVIZMsRZGS/TILlwbvH6NeNN/qOSu4Z.xYITCWgXYbG6cHcCDdIO.";

// Saved key
const saved = localStorage.getItem("savedKey");
if (saved) document.getElementById("loginKey").value = saved;

// Fetch keys
async function fetchKeys() {
  try {
    const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, { headers: {"X-Master-Key": API_KEY} });
    const data = await res.json();
    return data.record || { keys: [], blocked: [] };
  } catch(e){ console.error(e); return { keys: [], blocked: [] }; }
}

// Fetch buttons
async function fetchButtons(binId) {
  try {
    const res = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, { headers: {"X-Master-Key": API_KEY} });
    const data = await res.json();
    return data.record?.buttons || [];
  } catch(e){ return []; }
}

// Load old bin
async function loadVIPButtons() {
  const container = document.getElementById("dynamicButtons");
  container.innerHTML = "";
  const buttons = await fetchButtons(BTN_BIN_ID);
  buttons.forEach(btn => {
    const a = document.createElement("a");
    a.className = "box old-bin";
    a.href = btn.link;
    a.target = "_blank";
    a.textContent = btn.text;
    container.appendChild(a);
  });
}

// Load new bin
async function loadVIPButtons2() {
  const container = document.getElementById("dynamicButtons2");
  container.innerHTML = "";
  const buttons = await fetchButtons(BTN_BIN_ID_2);
  buttons.forEach(btn => {
    const a = document.createElement("a");
    a.className = "box new-bin";
    a.href = btn.link;
    a.target = "_blank";
    a.textContent = btn.text;
    container.appendChild(a);
  });
}

// Search function for both bins
function searchButtons() {
  const query = document.getElementById("searchBox").value.toLowerCase();
  const containers = [document.getElementById("dynamicButtons"), document.getElementById("dynamicButtons2")];
  containers.forEach(container => {
    Array.from(container.getElementsByTagName("a")).forEach(btn => {
      btn.style.display = btn.textContent.toLowerCase().includes(query) ? "block" : "none";
    });
  });
}

// Check key
async function checkKey() {
  const input = document.getElementById("loginKey").value.trim().toUpperCase();
  const popup = document.getElementById("popup");
  const db = await fetchKeys();
  const keys = db.keys || [];
  const blocked = db.blocked || [];

  if(blocked.includes(input)) {
    popup.textContent = "🚫 Blocked Key!";
    popup.className="popup error show";
    setTimeout(()=>popup.className="popup",2500);
    return;
  }

  const keyObj = keys.find(k=>k.key.toUpperCase()===input);
  if(keyObj){
    const now = new Date();
    const expiry = new Date(keyObj.expiry);
    if(now>expiry){
      popup.textContent = "⏳ Key Expired!";
      popup.className="popup error show";
      localStorage.removeItem("savedKey");
      document.getElementById("loginKey").value="";
      setTimeout(()=>popup.className="popup",2500);
      return;
    }
    popup.textContent="✅ Key Successful Login!";
    popup.className="popup success show";
    if(document.getElementById("saveKey").checked) localStorage.setItem("savedKey",input);
    setTimeout(()=>{
      document.getElementById("loginSection").classList.add("hidden");
      document.getElementById("vipSection").classList.remove("hidden");
      startCountdown(expiry);
      loadVIPButtons();
      loadVIPButtons2();
    },1000);
  } else {
    popup.textContent="❌ Wrong Key!";
    popup.className="popup error show";
    setTimeout(()=>popup.className="popup",2500);
  }
}

// Countdown
function startCountdown(expiryDate){
  const countdownDate = expiryDate.getTime();
  setInterval(()=>{
    const now = new Date().getTime();
    const distance = countdownDate - now;
    if(distance<0){ alert("Key Expired! Logging out..."); localStorage.removeItem("savedKey"); location.reload(); return; }
    document.getElementById("days").textContent = Math.floor(distance/(1000*60*60*24));
    document.getElementById("hours").textContent = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
    document.getElementById("minutes").textContent = Math.floor((distance%(1000*60*60))/(1000*60));
    document.getElementById("seconds").textContent = Math.floor((distance%(1000*60))/1000);
  },1000);
}
</script>

</body>
  </html>
